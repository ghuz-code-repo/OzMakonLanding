# Документация: Многостраннее форматирование телефонов

## Обзор

Система автоматического форматирования телефонных номеров для разных стран. Автоматически определяет код страны и применяет соответствующий формат.

## Поддерживаемые страны

| Код | Страна | Формат | Пример |
|-----|--------|--------|--------|
| +7 | Россия/Казахстан | +7 999 999 99 99| +7 999 123 45 67 |
| +998 | Узбекистан | +998 99 999 99 99| +998 90 123 45 67 |
| +996 | Кыргызстан | +996 999 999 999 | +996 555 123 456 |
| +992 | Таджикистан | +992 99 999 9999 | +992 90 123 4567 |
| +993 | Туркменистан | +993 99 999 999 | +993 65 123 456 |

## Как работает

### 1. Определение кода страны
```javascript
const detectCountryCode = (phone) => {
  // Проверяет номер по порядку убывания длины кода
  // 998, 996, 993, 992, 7
}
```

### 2. Применение формата
Каждая страна имеет свою функцию форматирования:
- `formatPhoneRussia()` - для +7
- `formatPhoneUzbekistan()` - для +998
- `formatPhoneKyrgyzstan()` - для +996
- `formatPhoneTajikistan()` - для +992
- `formatPhoneTurkmenistan()` - для +993

### 3. Ограничения по длине
Каждая страна имеет свой максимум цифр:
- +7: 11 символов (код + 10 цифр)
- +998: 12 символов (код + 9 цифр)
- +996: 12 символов (код + 9 цифр)
- +992: 12 символов (код + 9 цифр)
- +993: 11 символов (код + 8 цифр)

## Валидация для отправки

Несмотря на поддержку разных форматов, **только номера с кодом +998 разрешены для отправки формы**.

```javascript
const ALLOWED_COUNTRY_CODES = ['998'];
```

## Примеры использования

### Ввод российского номера:
```
Ввод: "79991234567"
Результат: "+7 999 123 45 67"
Валидация: ❌ (не разрешен для отправки)
```

### Ввод узбекского номера:
```
Ввод: "998901234567"
Результат: "+998 90 123 45 67"
Валидация: ✅ (разрешен для отправки)
```

### Ввод неизвестного кода:
```
Ввод: "1234567890"
Результат: "+1234567890"
Валидация: ❌ (неизвестная страна)
```

## API хука useInputValidation

### Новые функции:
- `formatPhoneNumber(value)` - универсальное форматирование
- `detectCountryCode(phone)` - определение кода страны
- `COUNTRY_PHONE_CONFIG` - конфигурация стран

### Обновленные функции:
- `handlePhoneInput()` - теперь использует `formatPhoneNumber`
- `getCountryCode()` - теперь использует `detectCountryCode`

## Тестирование

Используйте `test-phone.html` для тестирования всех форматов:

1. Откройте файл в браузере
2. Вводите номера разных стран
3. Наблюдайте автоматическое форматирование
4. Проверяйте валидацию кнопкой "Проверить валидацию"

## Конфигурация

Чтобы добавить новую страну:

1. Добавьте запись в `COUNTRY_PHONE_CONFIG`
2. Создайте функцию `formatPhone[Country]`
3. Добавьте case в `formatPhoneNumber`
4. При необходимости добавьте код в `ALLOWED_COUNTRY_CODES`

Пример добавления Украины (+380):
```javascript
'380': {
  name: 'Украина',
  format: '+380 99 999 99 99',
  maxLength: 12,
  pattern: /^380\d{9}$/
}
```
